<!DOCTYPE html>
<html>
<head>
    <title>Test Score Percentile Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f0f0f0;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
        }
        label, select, input, button {
            display: block;
            width: 100%;
            margin-top: 10px;
        }
        button {
            padding: 10px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background: #e9ecef;
            border-radius: 5px;
        }
    </style>
    <script>
        const satPercentiles = {
            1600: 99, 1590: 99, 1580: 99, 1570: 99, 1560: 99, 1550: 99, 1540: 99, 1530: 99,
            1520: 98, 1510: 98, 1500: 98, 1490: 97, 1480: 97, 1470: 96, 1460: 96, 1450: 96,
            1440: 95, 1430: 95, 1420: 94, 1410: 94, 1400: 93, 1390: 92, 1380: 92, 1370: 91,
            1360: 90, 1350: 90, 1340: 89, 1330: 88, 1320: 87, 1310: 87, 1300: 86, 1290: 85,
            1280: 84, 1270: 83, 1260: 82, 1250: 81, 1240: 80, 1230: 79, 1220: 78, 1210: 76,
            1200: 75, 1190: 74, 1180: 73, 1170: 71, 1160: 70, 1150: 69, 1140: 67, 1130: 66,
            1120: 64, 1110: 63, 1100: 61, 1090: 60, 1080: 58, 1070: 56, 1060: 55, 1050: 53,
            1040: 52, 1030: 50, 1020: 48, 1010: 47, 1000: 45, 990: 43, 980: 42, 970: 40,
            960: 39, 950: 37, 940: 36, 930: 34, 920: 32, 910: 31, 900: 29, 890: 28, 880: 26,
            870: 25, 860: 23, 850: 22, 840: 20, 830: 19, 820: 17, 810: 16, 800: 14, 790: 13,
            780: 12, 770: 10, 760: 9, 750: 8, 740: 7, 730: 6, 720: 5, 710: 4, 700: 3,
            690: 3, 680: 2, 670: 2, 660: 1, 650: 1, 640: 1, 630: 1, 620: 1, 610: 1, 600: 1,
            590: 1, 580: 1, 570: 1, 560: 1, 550: 1, 540: 1, 530: 1, 520: 1, 510: 1, 500: 1,
            490: 1, 480: 1, 470: 1, 460: 1, 450: 1, 440: 1, 430: 1, 420: 1, 410: 1, 400: 1
        };

        const psatPercentiles = {
            1440: 99, 1430: 99, 1420: 99, 1410: 98, 1400: 98, 1390: 98, 1380: 98, 1370: 98,
            1360: 98, 1350: 97, 1340: 97, 1330: 97, 1320: 97, 1310: 97, 1300: 96, 1290: 96,
            1280: 96, 1270: 96, 1260: 95, 1250: 95, 1240: 95, 1230: 95, 1220: 94, 1210: 94,
            1200: 94, 1190: 94, 1180: 93, 1170: 93, 1160: 93, 1150: 93, 1140: 92, 1130: 92,
            1120: 92, 1110: 92, 1100: 91, 1090: 91, 1080: 91, 1070: 91, 1060: 90, 1050: 90,
            1040: 90, 1030: 90, 1020: 89, 1010: 89, 1000: 89, 990: 89, 980: 88, 970: 88,
            960: 88, 950: 88, 940: 87, 930: 87, 920: 87, 910: 87, 900: 86, 890: 86, 880: 86,
            870: 86, 860: 85, 850: 85, 840: 85, 830: 85, 820: 84, 810: 84, 800: 84, 790: 84,
            780: 83, 770: 83, 760: 83, 750: 83, 740: 82, 730: 82, 720: 82, 710: 82, 700: 81,
            690: 81, 680: 81, 670: 81, 660: 80, 650: 80, 640: 80, 630: 80, 620: 79, 610: 79,
            600: 79, 590: 79, 580: 78, 570: 78, 560: 78, 550: 78, 540: 77, 530: 77, 520: 77,
            510: 77, 500: 76, 490: 76, 480: 76, 470: 76, 460: 75, 450: 75, 440: 75, 430: 75,
            420: 74, 410: 74, 400: 74
        };

        const inferScores = (score, grade) => {
            if (grade < 9) {
                const scaleFactor = grade / 9; // Simplified scaling
                return score * scaleFactor;
            }
            return score;
        };

        const interpolatePercentile = (percentiles, score) => {
            let lowerScore = Math.floor(score / 10) * 10;
            let upperScore = Math.ceil(score / 10) * 10;

            if (upperScore > 1600) upperScore = 1600;
            if (lowerScore < 400) lowerScore = 400;

            let lowerPercentile = percentiles[lowerScore] || 1;
            let upperPercentile = percentiles[upperScore] || 1;

            let interpolatedPercentile = lowerPercentile + (upperPercentile - lowerPercentile) * (score - lowerScore) / (upperScore - lowScore);

            return interpolatedPercentile;
    };

    function calculatePercentile() {
        const testType = document.getElementById('testType').value;
        const grade = parseInt(document.getElementById('grade').value);
        const score = parseInt(document.getElementById('score').value);

        const inferredScore = inferScores(score, grade);

        let percentile;
        if (testType === "sat") {
            percentile = interpolatePercentile(satPercentiles, inferredScore);
        } else if (testType === "psat") {
            percentile = interpolatePercentile(psatPercentiles, inferredScore);
        }

        document.getElementById('result').innerHTML = `
            <p>Test Type: ${testType.toUpperCase()}</p>
            <p>Grade: ${grade}</p>
            <p>Score: ${score}</p>
            <p>Inferred Score: ${inferredScore.toFixed(2)}</p>
            <p>Percentile: ${percentile.toFixed(4)}</p>
        `;
    }
</script>

