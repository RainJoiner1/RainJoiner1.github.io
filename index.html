<!DOCTYPE html>
<html>
<head>
    <title>Test Score Percentile Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f0f0f0;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
        }
        label, select, input, button {
            display: block;
            width: 100%;
            margin-top: 10px;
        }
        button {
            padding: 10px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background: #e9ecef;
            border-radius: 5px;
        }
    </style>
    <script>
        const satPercentiles = {
            1600: 99, 1590: 99, 1580: 99, 1570: 99, 1560: 99, 1550: 99, 1540: 99, 1530: 99,
            1520: 98, 1510: 98, 1500: 98, 1490: 97, 1480: 97, 1470: 96, 1460: 96, 1450: 96,
            1440: 95.5, 1430: 95, 1420: 94, 1410: 94, 1400: 93, 1390: 92, 1380: 92, 1370: 91,
            1360: 90, 1350: 90, 1340: 89, 1330: 88, 1320: 87, 1310: 87, 1300: 86, 1290: 85,
            1280: 84, 1270: 83, 1260: 82, 1250: 81, 1240: 80, 1230: 79, 1220: 78, 1210: 76,
            1200: 75, 1190: 74, 1180: 73, 1170: 71, 1160: 70, 1150: 69, 1140: 67, 1130: 66,
            1120: 64, 1110: 63, 1100: 61, 1090: 60, 1080: 58, 1070: 56, 1060: 55, 1050: 53,
            1040: 52, 1030: 50, 1020: 48, 1010: 47, 1000: 45, 990: 43, 980: 42, 970: 40,
            960: 39, 950: 37, 940: 36, 930: 34, 920: 32, 910: 31, 900: 29, 890: 28, 880: 26,
            870: 25, 860: 23, 850: 22, 840: 20, 830: 19, 820: 17, 810: 16, 800: 14, 790: 13,
            780: 12, 770: 10, 760: 9, 750: 8, 740: 7, 730: 6, 720: 5, 710: 4, 700: 3,
            690: 3, 680: 2, 670: 2, 660: 1, 650: 1, 640: 1, 630: 1, 620: 1, 610: 1, 600: 1,
            590: 1, 580: 1, 570: 1, 560: 1, 550: 1, 540: 1, 530: 1, 520: 1, 510: 1, 500: 1,
            490: 1, 480: 1, 470: 1, 460: 1, 450: 1, 440: 1, 430: 1, 420: 1, 410: 1, 400: 1
        };

        const psatPercentiles = {
            1440: 99, 1430: 99, 1420: 99, 1410: 99, 1400: 99, 1390: 99, 1380: 99, 1370: 99,
            1360: 99, 1350: 99, 1340: 99, 1330: 99, 1320: 99, 1310: 99, 1300: 98, 1290: 98,
            1280: 98, 1270: 98, 1260: 97, 1250: 97, 1240: 97, 1230: 97, 1220: 96, 1210: 96,
            1200: 96, 1190: 95, 1180: 95, 1170: 94, 1160: 94, 1150: 93, 1140: 93, 1130: 92,
            1120: 91, 1110: 90, 1100: 90, 1090: 89, 1080: 88, 1070: 87, 1060: 86, 1050: 85,
            1040: 83, 1030: 82, 1020: 81, 1010: 80, 1000: 78, 990: 77, 980: 75, 970: 74,
            960: 72, 950: 70, 940: 68, 930: 67, 920: 65, 910: 63, 900: 61, 890: 59, 880: 57,
            870: 55, 860: 53, 850: 51, 840: 49, 830: 47, 820: 44, 810: 42, 800: 40, 790: 38,
            780: 35, 770: 33, 760: 31, 750: 28, 740: 26, 730: 24, 720: 21, 710: 19, 700: 17,
            690: 15, 680: 13, 670: 12, 660: 10, 650: 9, 640: 8, 630: 7, 620: 6, 610: 5,
            600: 5, 590: 4, 580: 3, 570: 3, 560: 3, 550: 2, 540: 2, 530: 2, 520: 2, 510: 1,
            500: 1, 490: 1, 480: 1, 470: 1, 460: 1, 450: 1, 440: 1, 430: 1, 420: 1, 410: 1,
            400: 1
        };

        const inferScores = (score, grade) => {
            if (grade < 9) {
                const scaleFactor = grade / 9; // Simplified scaling
                return score * scaleFactor;
            }
            return score;
        };

        const interpolatePercentile = (percentiles, score) => {
            let lowerScore = Math.floor(score / 10) * 10;
            let upperScore = Math.ceil(score / 10) * 10;

            if (upperScore > 1600) upperScore = 1600;
            if (lowerScore < 400) lowerScore = 400;

            let lowerPercentile = percentiles[lowerScore] || 1;
            let upperPercentile = percentiles[upperScore] || 1;

            let interpolatedPercentile = lowerPercentile + (upperPercentile - lowerPercentile) * (score - lowerScore) / (upperScore - lowerScore);

            return interpolatedPercentile;
        };

        function calculatePercentile() {
            const testType = document.getElementById('testType').value;
            const grade = parseInt(document.getElementById('grade').value);
            const score = parseInt(document.getElementById('score').value);

            const inferredScore = inferScores(score, grade);

            let percentile;
            if (testType === "sat") {
                percentile = interpolatePercentile(satPercentiles, inferredScore);
            } else if (testType === "psat") {
                percentile = interpolatePercentile(psatPercentiles, inferredScore);
            }

            document.getElementById('result').innerHTML = `
                <p>Test Type: ${testType.toUpperCase()}</p>
                <p>Grade: ${grade}</p>
                <p>Score: ${score}</p>
                <p>Inferred Score: ${inferredScore.toFixed(2)}</p>
                <p>Percentile: ${percentile.toFixed(4)}</p>
            `;
        }
    </script>
</head>
<body>
    <div class="container">
        <h1>Test Score Percentile Calculator</h1>
        <label for="testType">Select Test Type:</label>
        <select id="testType">
            <option value="sat">SAT</option>
            <option value="psat">PSAT</option>
        </select>
        <label for="grade">Enter Grade (K-12):</label>
        <input type="number" id="grade" min="0" max="12" />
        <label for="score">Enter Your Score:</label>
        <input type="number" id="score" min="200" max="1600" />
        <button onclick="calculatePercentile()">Calculate Percentile</button>
        <div id="result" class="result"></div>
    </div>
</body>
</html>
