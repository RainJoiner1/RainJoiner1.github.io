<!DOCTYPE html>
<html>
<head>
    <title>Test Score Percentile Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f0f0f0;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
        }
        label, select, input, button {
            display: block;
            width: 100%;
            margin-top: 10px;
        }
        button {
            padding: 10px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background: #e9ecef;
            border-radius: 5px;
        }
    </style>
    <script>
        const satPercentiles = {
            1600: 99, 1590: 99, 1580: 99, 1570: 99, 1560: 99, 1550: 99, 1540: 99, 1530: 99,
            1520: 98, 1510: 98, 1500: 98, 1490: 97, 1480: 97, 1470: 96, 1460: 96, 1450: 96,
            1440: 95, 1430: 95, 1420: 94, 1410: 94, 1400: 93, 1390: 92, 1380: 92, 1370: 91,
            1360: 90, 1350: 90, 1340: 89, 1330: 88, 1320: 87, 1310: 87, 1300: 86, 1290: 85,
            1280: 84, 1270: 83, 1260: 82, 1250: 81, 1240: 80, 1230: 79, 1220: 78, 1210: 76,
            1200: 75
        };

        const psatPercentiles = {
            1440: 99, 1430: 99, 1420: 99, 1410: 99, 1400: 99, 1390: 99, 1380: 99, 1370: 99,
            1360: 99, 1350: 99, 1340: 99, 1330: 99, 1320: 99, 1310: 99, 1300: 98, 1290: 98,
            1280: 98, 1270: 98, 1260: 97, 1250: 97, 1240: 97, 1230: 97, 1220: 96, 1210: 96,
            1200: 96
        };

        const adjustMean = (score, grade) => {
            const meanAdjustment = {
                11: 20,
                10: 40,
                9: 60,
                8: 80,
                7: 100,
                6: 120,
                5: 140,
                4: 160,
                3: 180,
                2: 200,
                1: 220,
                0: 240
            };
            return score - meanAdjustment[grade];
        };

        const interpolatePercentile = (percentiles, score) => {
            let lowerScore = Math.floor(score / 10) * 10;
            let upperScore = Math.ceil(score / 10) * 10;

            if (upperScore > 1600) upperScore = 1600;
            if (lowerScore < 400) lowerScore = 400;

            let lowerPercentile = percentiles[lowerScore] || 1;
            let upperPercentile = percentiles[upperScore] || 1;

            let interpolatedPercentile = lowerPercentile + (upperPercentile - lowerPercentile) * (score - lowerScore) / (upperScore - lowerScore);

            return interpolatedPercentile;
        };

        function calculatePercentile() {
            const testType = document.getElementById('testType').value;
            const grade = parseInt(document.getElementById('grade').value);
            const score = parseInt(document.getElementById('score').value);

            const adjustedScore = adjustMean(score, grade);

            let percentile;
            if (testType === "sat") {
                percentile = interpolatePercentile(satPercentiles, adjustedScore);
            } else if (testType === "psat") {
                percentile = interpolatePercentile(psatPercentiles, adjustedScore);
            }

            document.getElementById('result').innerHTML = `
                <p>Test Type: ${testType.toUpperCase()}</p>
                <p>Grade: ${grade}</p>
                <p>Score: ${score}</p>
                <p>Adjusted Score: ${adjustedScore.toFixed(2)}</p>
                <p>Percentile: ${percentile.toFixed(2)}</p>
            `;
        }

        document.addEventListener('DOMContentLoaded', (event) => {
            document.getElementById('calculateButton').addEventListener('click', calculatePercentile);
        });
    </script>
</head>
<body>
    <div class="container">
        <h1>Test Score Percentile Calculator</h1>
        <label for="testType">Select Test Type:</label>
        <select id="testType">
            <option value="sat">SAT</option>
            <option value="psat">PSAT</option>
        </select>
        <label for="grade">Enter Grade (K-12):</label>
        <input type="number" id="grade" min="0" max="12" />
        <label for="score">Enter Your Score:</label>
        <input type="number" id="score" min="200" max="1600" />
        <button id="calculateButton">Calculate Percentile</button>
        <div id="result" class="result"></div>
    </div>
</body>
</html>
